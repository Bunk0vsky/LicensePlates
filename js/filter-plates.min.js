let params = new URLSearchParams(document.location.search);
const filterPlates = async (e) => {
    selectState(e?.textContent),
      await resetFilters("Stany Zjednoczone", e?.textContent);
  },
  displayAll = async () => {
    selectCategory(""),
      selectState(""),
      removeElements(),
      (currentPage = 1),
      (platesStartRange = 0),
      (platesEndRange = 20);
    const e = await displayMore();
    infiniteSCroll(e?.count || 0),
      url.searchParams.delete("country"),
      url.searchParams.delete("state"),
      url.searchParams.delete("year"),
      window.history.pushState(null, "", url.toString());
  };
var sortBy = "country asc, state asc",
  platesStartRange = 0,
  platesEndRange = 20,
  selectedCategory = "",
  selectedState = "";
const displayMore = async (e, t, a) => {
  const n = e || selectedCategory,
    s = n && "null" !== n ? `&& country == "${n}"` : "",
    l = (void 0 === t || "undefined" === t ? null : t) || selectedState,
    r = l && "null" !== l ? `&& state == "${l}"` : "";
  let o = encodeURIComponent(
      `{\n      "list":*[_type == "plate" ${s} ${r}] {\n      ...,\n      "imageUrl": src.asset->url\n    } | order(${
        a || sortBy
      }) [${platesStartRange}...${platesEndRange}],\n      "count": count(*[_type == "plate" ${s} ${r}]{\n        ...,\n      }),\n  }\n    \n  `
    ),
    c = `https://${PROJECT_ID}.api.sanity.io/v2021-10-21/data/query/${DATASET}?query=${o}`;
  const d = await fetch(c);
  let { result: i } = await d.json();
  if (i?.list.length > 0) {
    const e = document.getElementById("loader");
    e?.classList?.add("hidden");
    let t = document.getElementById("shop-bar");
    if (t) {
      const e = t.querySelectorAll(".shop"),
        a = [];
      e.forEach((e) => a.push(e.getAttribute("data-modal")));
      i.list
        .filter((e) => -1 === a.indexOf(e._id))
        .forEach((e) => {
          generatePlate(e, t);
        });
    }
  }
  return i;
};
