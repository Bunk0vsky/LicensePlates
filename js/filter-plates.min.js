function getConditionStatus(e) {
  let t = "";
  switch (e) {
    case "Roadkill":
      t = "road-kill";
      break;
    case "Słaby":
      t = "poor";
      break;
    case "Dostateczny":
      t = "sufficent";
      break;
    case "Dobry":
      t = "good";
      break;
    case "Bardzo dobry":
      t = "very-good";
  }
  return t;
}
const conditionElement =
  '<div class="element"></div> \n<div class="element"></div>\n<div class="element"></div>\n<div class="element"></div> \n<div class="element"></div>';
let PROJECT_ID = "3gobi7i4",
  DATASET = "production",
  lastId = "",
  QUERY_ALL_PLATES_PROMO = encodeURIComponent(
    '*[_type == "plate" && isPromo == true][0...8]{\n...,\n"imageUrl": src.asset->url\n} | order(_createdAt asc)'
  ),
  QUERY_ALL_PLATES_NEW = encodeURIComponent(
    '*[_type == "plate" && isPromo != true][0...8]{\n...,\n"imageUrl": src.asset->url\n} | order(_createdAt asc)'
  ),
  QUERY_ONLY_PLATES_PROMO = encodeURIComponent(
    '*[_type == "plate" && isPromo == true]{\n  ...,\n  "imageUrl": src.asset->url\n  } | order(_createdAt asc)'
  ),
  URL_to_get_plates = `https://${PROJECT_ID}.api.sanity.io/v2021-10-21/data/query/${DATASET}?query=${QUERY_ALL_PLATES_PROMO}`,
  URL_to_get_new_plates = `https://${PROJECT_ID}.api.sanity.io/v2021-10-21/data/query/${DATASET}?query=${QUERY_ALL_PLATES_NEW}`,
  URL_to_get_promo_plates = `https://${PROJECT_ID}.api.sanity.io/v2021-10-21/data/query/${DATASET}?query=${QUERY_ONLY_PLATES_PROMO}`;
const generatePlate = (e, t) => {
  const a = document.createElement("div");
  (a.className = "shop-wrapper"), t.appendChild(a);
  const n = document.createElement("div");
  (n.className = "shop"),
    n.setAttribute("onclick", "openShopCard(this);"),
    n.setAttribute("data-modal", e._id),
    e.isPromo && n.classList.add("discount"),
    a.appendChild(n);
  const o = document.createElement("div");
  (o.className = "image-wrapper"), n.appendChild(o);
  const s = document.createElement("img");
  (s.className = "shop-img"),
    (s.src = e.imageUrl || "/img/no-image.svg"),
    (s.alt = e.alt),
    (s.loading = "lazy"),
    o.appendChild(s);
  const l = document.createElement("div");
  (l.className = "shop-content"), n.appendChild(l);
  const d = document.createElement("div");
  l.appendChild(d);
  let c = "Reszta Świata" === e.country ? e.alt : "",
    i = "Zestawy tablic" === e.country ? e.alt : "",
    r = "Ramki" === e.country ? e.alt : "",
    m =
      "Reszta Świata" !== e.country &&
      "Zestawy tablic" !== e.country &&
      "Ramki" !== e.country
        ? e.country
        : "";
  const p = document.createElement("p");
  (p.className = "shop-title"),
    (p.innerHTML = e.state || m || c || i || r),
    d.appendChild(p);
  const h = document.createElement("p");
  (h.className = "shop-size"),
    (h.innerHTML = e.sizeLength
      ? `<span data-translate="shopPlateSize">Wymiary:</span> ${e.sizeLength} x ${e.sizeWidth}`
      : ""),
    d.appendChild(h);
  const u = document.createElement("p");
  (u.className = "shop-year"),
    (u.textContent = e.year && `Rok: ${e.year}`),
    d.appendChild(u);
  const E = document.createElement("p");
  (E.className = "shop-condition"),
    (E.innerHTML = '<span data-translate="shopPlateStatus">Status: </span>'),
    d.appendChild(E);
  const y = document.createElement("p");
  (y.className = "shop-id"),
    (y.innerHTML = `<span data-translate="shopPlateId">Nr. oferty:</span> ${e.plateId}`),
    d.appendChild(y);
  const g = document.createElement("div"),
    C = getConditionStatus(e.condition);
  (g.classList = `condition-bar ${C}`),
    (g.innerHTML = conditionElement),
    E.appendChild(g);
  const L = document.createElement("p");
  if (((L.className = "shop-pricing"), l.appendChild(L), e.isPromo)) {
    const t = document.createElement("span");
    (t.className = "old-price"),
      (t.textContent = `PLN ${e.oldPrice}`),
      L.appendChild(t);
  }
  const P = document.createElement("span");
  (P.textContent = `PLN ${e.price}`), L.appendChild(P);
  const v = document.createElement("div");
  (v.className = "modal"), (v.id = e._id), a.appendChild(v);
  const _ = document.createElement("div");
  (_.className = "modal-bg modal-exit"), v.appendChild(_);
  const N = document.createElement("div");
  (N.className = "modal-container"), v.appendChild(N);
  const $ = document.createElement("div");
  ($.className = "modal-card"), N.appendChild($);
  const b = document.createElement("img");
  (b.className = "modal-img"),
    (b.src = e.imageUrl || "/img/no-image.svg"),
    (b.alt = e.alt),
    (b.loading = "lazy"),
    $.appendChild(b);
  const I = document.createElement("div");
  (I.className = "modal-card"), N.appendChild(I);
  const R =
      "Reszta Świata" === e.country
        ? ` <span data-translate="modalShopPlateCountry">Kraj: </span>${e.alt}`
        : "",
    S =
      "Zestawy tablic" === e.country
        ? `<span data-translate="modalShopPlateItem">Przedmiot: </span>${e.alt}`
        : "",
    T =
      "Ramki" === e.country
        ? `<span data-translate="modalShopPlateItem">Przedmiot: </span>${e.alt}`
        : "",
    z =
      "Reszta Świata" !== e.country &&
      "Zestawy tablic" !== e.country &&
      "Ramki" !== e.country
        ? ` <span data-translate="modalShopPlateCountry">Kraj: </span>${e.country}`
        : "",
    M = document.createElement("p");
  (M.innerHTML = `${R} ${S} ${T} ${z}`), I.appendChild(M);
  const f = e.state,
    w = document.createElement("p");
  (w.innerHTML = f
    ? `<span data-translate="modalShopPlateState">Stan: </span> ${e.state}`
    : ""),
    I.appendChild(w);
  const x = document.createElement("p");
  (x.innerHTML = e.sizeLength
    ? `<span data-translate="modalShopPlateSize">Wymiary tablicy: </span> ${e.sizeLength} x ${e.sizeWidth}`
    : ""),
    I.appendChild(x);
  const A = document.createElement("p");
  (A.innerHTML = e.year
    ? `<span data-translate="modalShopYear">Rok wydania:</span> ${e.year}`
    : ""),
    I.appendChild(A);
  const U = document.createElement("p");
  (U.style = "display: flex; align-items: center; "),
    (U.innerHTML =
      '<span data-translate="modalShopPlateStatus">Status: </span>'),
    I.appendChild(U);
  const H = document.createElement("p");
  (H.className = "shop-id"),
    (H.innerHTML = `<span data-translate="modalShopId">Nr. oferty: </span> ${e.plateId} `),
    I.appendChild(H);
  const k = document.createElement("div"),
    B = getConditionStatus(e.condition);
  (k.classList = `condition-bar ${B}`),
    (k.innerHTML = conditionElement),
    U.appendChild(k);
  const O = document.createElement("div");
  if (((O.className = "modal-price"), I.appendChild(O), e.isPromo)) {
    const t = document.createElement("span");
    (t.className = "old-price"),
      (t.textContent = `PLN ${e.oldPrice}`),
      O.appendChild(t);
  }
  const j = document.createElement("span");
  (j.className = "current-price"),
    (j.textContent = `PLN ${e.price}`),
    O.appendChild(j);
  const D = document.createElement("button");
  (D.className = "modal-close modal-exit"),
    (D.textContent = "X"),
    N.appendChild(D);
};
function generatePromoPlate(e, t) {
  const a = document.createElement("div");
  (a.className = "promo-wrapper"), t.appendChild(a);
  const n = document.createElement("div");
  (n.className = "promo"),
    n.setAttribute("onclick", "openShopCard(this);"),
    n.setAttribute("data-modal", e._id),
    a.appendChild(n);
  const o = document.createElement("div");
  (o.className = "image-wrapper"), n.appendChild(o);
  const s = document.createElement("img");
  (s.className = "promo-img"),
    (s.src = e.imageUrl || "/img/no-image.svg"),
    (s.alt = e.alt),
    (s.loading = "lazy"),
    o.appendChild(s);
  const l = document.createElement("div");
  (l.className = "promo-content"), n.appendChild(l);
  const d = document.createElement("div");
  l.appendChild(d);
  const c = "Reszta Świata" === e.country ? e.alt : "",
    i = "Zestawy tablic" === e.country ? e.alt : "",
    r = "Ramki" === e.country ? e.alt : "",
    m =
      "Reszta Świata" !== e.country &&
      "Zestawy tablic" !== e.country &&
      "Ramki" !== e.country
        ? e.country
        : "",
    p = document.createElement("p");
  (p.className = "promo-title"),
    (p.innerHTML = e.state || m || c || i || r),
    d.appendChild(p);
  const h = document.createElement("p");
  (h.className = "promo-size"),
    (h.innerHTML = e.sizeLength
      ? `<span data-translate="promoPlateSize">Wymiary:</span> ${e.sizeLength} x ${e.sizeWidth}`
      : ""),
    d.appendChild(h);
  const u = document.createElement("p");
  (u.className = "promo-year"),
    (u.textContent = e.year && `Rok: ${e.year}`),
    d.appendChild(u);
  const E = document.createElement("p");
  (E.style = "display: flex; align-items: center; "),
    (E.className = "promo-condition"),
    (E.innerHTML = '<span data-translate="promoPlateStatus">Status: </span>'),
    d.appendChild(E);
  const y = document.createElement("p");
  (y.className = "promo-id"),
    (y.innerHTML = `<span data-translate="promoPlateId">Nr. oferty:</span> ${e.plateId}`),
    d.appendChild(y);
  const g = document.createElement("div"),
    C = getConditionStatus(e.condition);
  (g.classList = `condition-bar ${C}`),
    (g.innerHTML = conditionElement),
    E.appendChild(g);
  const L = document.createElement("p");
  (L.className = "promo-pricing"), l.appendChild(L);
  const P = document.createElement("span");
  (P.className = "old-price"),
    (P.textContent = `PLN ${e.oldPrice}`),
    L.appendChild(P);
  const v = document.createElement("span");
  (v.textContent = `PLN ${e.price}`), L.appendChild(v);
  const _ = document.createElement("div");
  (_.className = "modal"), (_.id = e._id), a.appendChild(_);
  const N = document.createElement("div");
  (N.className = "modal-bg modal-exit"), _.appendChild(N);
  const $ = document.createElement("div");
  ($.className = "modal-container"), _.appendChild($);
  const b = document.createElement("div");
  (b.className = "modal-card"), $.appendChild(b);
  const I = document.createElement("img");
  (I.className = "modal-img"),
    (I.src = e.imageUrl || "/img/no-image.svg"),
    (I.alt = e.alt),
    (I.loading = "lazy"),
    b.appendChild(I);
  const R = document.createElement("div");
  (R.className = "modal-card"), $.appendChild(R);
  const S =
      "Reszta Świata" === e.country
        ? ` <span data-translate="promoModalShopPlateCountry">Kraj: </span>${e.alt}`
        : "",
    T =
      "Zestawy tablic" === e.country
        ? `<span data-translate="promoModalodalShopPlateItem">Przedmiot: </span>${e.alt}`
        : "",
    z =
      "Ramki" === e.country
        ? `<span data-translate="promoModalodalShopPlateItem">Przedmiot: </span>${e.alt}`
        : "",
    M =
      "Reszta Świata" !== e.country &&
      "Zestawy tablic" !== e.country &&
      "Ramki" !== e.country
        ? ` <span data-translate="promoModalPlateCountry">Kraj: </span>${e.country}`
        : "",
    f = document.createElement("p"),
    w = e.state;
  (f.innerHTML = `${S} ${T} ${z} ${M}`), R.appendChild(f);
  const x = document.createElement("p");
  (x.innerHTML = w
    ? `<span data-translate="promoModalPlateState">Stan: </span> ${e.state}`
    : ""),
    R.appendChild(x);
  const A = document.createElement("p");
  (A.innerHTML = e.sizeLength
    ? `<span data-translate="promoModalPlateSize">Wymiary tablicy:</span> ${e.sizeLength} x ${e.sizeWidth}`
    : ""),
    R.appendChild(A);
  const U = document.createElement("p");
  (U.innerHTML = e.year ? `<span>Rok wydania:</span> ${e.year}` : ""),
    R.appendChild(U);
  const H = document.createElement("p");
  (H.style = "display: flex; align-items: center; "),
    (H.innerHTML =
      '<span data-translate="promoModalPlateStatus">Status: </span>'),
    R.appendChild(H);
  const k = document.createElement("p");
  (k.className = "shop-id"),
    (k.innerHTML = `<span data-translate="promoModalPlateId">Nr. oferty: </span> ${e.plateId} `),
    R.appendChild(k);
  const B = document.createElement("div"),
    O = getConditionStatus(e.condition);
  (B.classList = `condition-bar ${O}`),
    (B.innerHTML = conditionElement),
    H.appendChild(B);
  const j = document.createElement("div");
  (j.className = "promo-modal-price"), R.appendChild(j);
  const D = document.createElement("p");
  (D.className = "old-price"),
    (D.style = "font-size: 1.4rem"),
    (D.textContent = `PLN ${e.oldPrice}`),
    j.appendChild(D);
  const W = document.createElement("p");
  (W.className = "current-price"),
    (W.style = "font-size: 2.0rem"),
    (W.textContent = `PLN ${e.price}`),
    j.appendChild(W);
  const Y = document.createElement("button");
  (Y.className = "modal-close modal-exit"),
    (Y.textContent = "X"),
    $.appendChild(Y);
}
const getPlates = () => {
  fetch(URL_to_get_plates)
    .then((e) => e.json())
    .then(({ result: e }) => {
      const t = setInterval(() => {
        const a = document.getElementById("banner-index"),
          n = document.getElementById("loader-index"),
          o = document.getElementById("promo-bar");
        o &&
          (e.length > 0
            ? (n?.classList?.add("hidden"),
              a?.classList.remove("visible"),
              clearInterval(t),
              e.forEach((e) => {
                generatePromoPlate(e, o);
              }))
            : a &&
              (a?.classList.add("visible"),
              n?.classList?.add("hidden"),
              clearInterval(t)));
      }, 1e3);
    })
    .catch((e) => console.error(e)),
    fetch(URL_to_get_new_plates)
      .then((e) => e.json())
      .then(({ result: e }) => {
        const t = document.getElementById("banner");
        if (e?.length > 0) {
          const a = document.getElementById("shop-bar-main");
          t?.classList?.remove("visible"),
            a &&
              e
                .filter((e) => !e.isPromo)
                .forEach((e) => {
                  a && generatePlate(e, a);
                });
        } else 0 === e.length && t?.classList?.add("visible");
      });
};
fetch(URL_to_get_plates)
  .then((e) => e.json())
  .then(({ result: e }) => {
    const t = setInterval(() => {
      const a = document.getElementById("banner-index"),
        n = document.getElementById("loader-index"),
        o = document.getElementById("promo-bar");
      o &&
        (e.length > 0
          ? (n?.classList?.add("hidden"),
            a?.classList.remove("visible"),
            clearInterval(t),
            e.forEach((e) => {
              generatePromoPlate(e, o);
            }))
          : a &&
            (a?.classList.add("visible"),
            n?.classList?.add("hidden"),
            clearInterval(t)));
    }, 1e3);
  })
  .catch((e) => console.error(e)),
  fetch(URL_to_get_new_plates)
    .then((e) => e.json())
    .then(({ result: e }) => {
      const t = document.getElementById("banner");
      if (e?.length > 0) {
        const a = document.getElementById("shop-bar-main");
        t?.classList?.remove("visible"),
          a &&
            e
              .filter((e) => !e.isPromo)
              .forEach((e) => {
                a && generatePlate(e, a);
              });
      } else 0 === e.length && t?.classList?.add("visible");
    });
const getPromoPlates = () => {
  fetch(URL_to_get_promo_plates)
    .then((e) => e.json())
    .then(({ result: e }) => {
      const t = setInterval(() => {
        const a = document.getElementById("promo-bar-page"),
          n = document.getElementById("banner-promo"),
          o = document.getElementById("loader-promo");
        a &&
          (e.length > 0
            ? (o.classList.add("hidden"),
              clearInterval(t),
              e.forEach((e) => {
                generatePromoPlate(e, a);
              }))
            : n &&
              (n.classList.add("visible"),
              o.classList.add("hidden"),
              clearInterval(t)));
      }, 1e3);
    })
    .catch((e) => console.error(e));
};
window.addEventListener("load", (e) => {
  "#promocje" === e.currentTarget.location.hash &&
    (console.log("Z załadowania"),
    fetch(URL_to_get_promo_plates)
      .then((e) => e.json())
      .then(({ result: e }) => {
        const t = setInterval(() => {
          const a = document.getElementById("promo-bar-page"),
            n = document.getElementById("banner-promo"),
            o = document.getElementById("loader-promo");
          a &&
            (e.length > 0
              ? (o.classList.add("hidden"),
                clearInterval(t),
                e.forEach((e) => {
                  generatePromoPlate(e, a);
                }))
              : n &&
                (n.classList.add("visible"),
                o.classList.add("hidden"),
                clearInterval(t)));
        }, 1e3);
      })
      .catch((e) => console.error(e)));
});
